#!/data/data/com.termux/files/usr/bin/bash
# bdsys - Bangladeshi System Info Tool

# Colors
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
PURPLE='\033[0;35m'
CYAN='\033[0;36m'
NC='\033[0m'

# Bangladeshi Banner
echo -e "${GREEN}"
echo "╔══════════════════════════════════════╗"
echo "║           🇧🇩 BD SYS INFO           ║"
echo "║        Created by Masum Vai         ║"
echo "╚══════════════════════════════════════╝"
echo -e "${NC}"

# System Information
echo -e "${YELLOW}📱 DEVICE INFORMATION${NC}"
echo -e "${GREEN}┌─ Model:${NC} $(getprop ro.product.model 2>/dev/null || echo 'Unknown')"
echo -e "${GREEN}├─ Brand:${NC} $(getprop ro.product.brand 2>/dev/null || echo 'Unknown')"
echo -e "${GREEN}├─ Android:${NC} $(getprop ro.build.version.release 2>/dev/null || echo 'Unknown')"
echo -e "${GREEN}└─ API:${NC} $(getprop ro.build.version.sdk 2>/dev/null || echo 'Unknown')"

# Termux Information
echo -e "\n${YELLOW}🐧 TERMUX INFORMATION${NC}"
echo -e "${GREEN}┌─ Version:${NC} $(pkg show termux-tools 2>/dev/null | grep Version | awk '{print $2}' || echo 'Unknown')"
echo -e "${GREEN}├─ Prefix:${NC} $PREFIX"
echo -e "${GREEN}├─ Shell:${NC} $SHELL"
echo -e "${GREEN}├─ User:${NC} $(whoami)"
echo -e "${GREEN}└─ Home:${NC} $HOME"

# Storage Information
echo -e "\n${YELLOW}💾 STORAGE INFORMATION${NC}"
df -h $HOME 2>/dev/null | tail -n +2 | while read output; do
    filesystem=$(echo $output | awk '{print $1}')
    size=$(echo $output | awk '{print $2}')
    used=$(echo $output | awk '{print $3}')
    avail=$(echo $output | awk '{print $4}')
    percent=$(echo $output | awk '{print $5}')
    mount=$(echo $output | awk '{print $6}')
    echo -e "${GREEN}┌─ Filesystem:${NC} $filesystem"
    echo -e "${GREEN}├─ Size:${NC} $size | Used: $used | Free: $avail"
    echo -e "${GREEN}└─ Usage:${NC} $percent on $mount"
done

# Memory Information
echo -e "\n${YELLOW}🧠 MEMORY INFORMATION${NC}"
if [ -f /proc/meminfo ]; then
    total_mem=$(grep MemTotal /proc/meminfo | awk '{print $2}')
    free_mem=$(grep MemFree /proc/meminfo | awk '{print $2}')
    available_mem=$(grep MemAvailable /proc/meminfo | awk '{print $2}')
    
    total_mem_mb=$((total_mem / 1024))
    free_mem_mb=$((free_mem / 1024))
    available_mem_mb=$((available_mem / 1024))
    used_mem_mb=$((total_mem_mb - available_mem_mb))
    usage_percent=$((used_mem_mb * 100 / total_mem_mb))
    
    echo -e "${GREEN}┌─ Total RAM:${NC} ${total_mem_mb}MB"
    echo -e "${GREEN}├─ Used RAM:${NC} ${used_mem_mb}MB (${usage_percent}%)"
    echo -e "${GREEN}├─ Free RAM:${NC} ${free_mem_mb}MB"
    echo -e "${GREEN}└─ Available:${NC} ${available_mem_mb}MB"
else
    echo -e "${RED}❌ Memory info not available${NC}"
fi

# Package Information
echo -e "\n${YELLOW}📦 PACKAGE INFORMATION${NC}"
installed_pkgs=$(pkg list-installed 2>/dev/null | wc -l)
echo -e "${GREEN}┌─ Installed:${NC} $installed_pkgs packages"
echo -e "${GREEN}└─ Last Update:${NC} $(stat -c %y $PREFIX/var/lib/dpkg/status 2>/dev/null | cut -d' ' -f1 || echo 'Unknown')"

# Network Information
echo -e "\n${YELLOW}🌐 NETWORK INFORMATION${NC}"
ip_addr=$(ip route get 1 2>/dev/null | awk '{print $7}' | head -1)
if [ -n "$ip_addr" ] && [ "$ip_addr" != "dev" ]; then
    echo -e "${GREEN}┌─ Local IP:${NC} $ip_addr"
else
    echo -e "${RED}┌─ Local IP:${NC} Not connected"
fi

public_ip=$(curl -s --connect-timeout 5 https://api.ipify.org 2>/dev/null)
if [ -n "$public_ip" ]; then
    echo -e "${GREEN}├─ Public IP:${NC} $public_ip"
    
    # Get IP location (Bangladesh check)
    country=$(curl -s --connect-timeout 5 "http://ip-api.com/json/$public_ip?fields=country" | grep -o '"country":"[^"]*' | cut -d'"' -f4)
    if [ "$country" = "Bangladesh" ]; then
        echo -e "${GREEN}└─ Location:${NC} 🇧🇩 Bangladesh"
    elif [ -n "$country" ]; then
        echo -e "${GREEN}└─ Location:${NC} $country"
    else
        echo -e "${GREEN}└─ Location:${NC} Unknown"
    fi
else
    echo -e "${RED}└─ Public IP:${NC} Not available"
fi

# Uptime
echo -e "\n${YELLOW}⏰ SYSTEM UPTIME${NC}"
uptime -p | sed 's/up //' | while read uptime; do
    echo -e "${GREEN}└─ Uptime:${NC} $uptime"
done

# Bangladeshi Time
echo -e "\n${YELLOW}🕒 BANGLADESH TIME${NC}"
echo -e "${GREEN}└─ Current:${NC} $(TZ='Asia/Dhaka' date '+%Y-%m-%d %H:%M:%S %Z')"

echo -e "\n${CYAN}✨ System check completed by Masum Vai! 🇧🇩${NC}"